# Prova 1

## Projeto Ágil e Programação Eficaz - frente de programação

**Atenção** este projeto de código vale 8.0 pontos. Esta prova é complementada por uma primeira questão feita em papel 

# Q1 - Questão sobre modelo de objetos 
**Valor 4 pontos**

Atenção: existem testes unitários no projeto para ajudá-lo a avançar nesta fase. Rode pytest -v na pasta inicial do projeto para ver as dicas. 

Você pode ler os testes do arquivo `src/test/test_tdd_prova.py` para entender como os objetos funcionam. Mas não é esperado que você edite este arquivo. 


## 1.1 Método para buscar usuários

Adicionar na classe `User` um método chamado `buscar_usuario_ativo` que deve receber como parâmetro um `int` que corresponde ao **id** de um usuário. 

**Atenção:** este é o único método desta questão que recebe um **id** inteiro em vez de um objeto. 

Este método vai ser chamado diretamente na classe, sem que seja preciso criar um objeto para poder chamá-lo. 

O valor de retorno deve ser o usuário, se ele existe na estrutura que guarda usuários ativos.

**Atenção:** Nesta questão não é necessário usar SQL. Vamos buscar objetos da classe `User` que estejam na memória.  Cabe a você identificar como estes usuários já estão guardados. 

## 1.2 Método para adicionar amigos 

Crie na classe `User` um método chamado `adicionar_amigo` que receberá como parâmetro outro objeto `amigo2` da classe `User` para adicionar como amigo.

Este método deve retornar `True` se o `amigo2` de fato foi adicionado.  

Caso o `amigo2` já existisse previamente na lista de amigos, o método deve retornar `False`.

A variável `qtd_amigos` pertencente aos objetos da classe `User` deve ser atualizada adequadamente tanto no próprio objeto quanto no objeto `amigo2` recebido. 

O próprio objeto da classe `User` - o `self` - precisa também se adicionar como amigo no `amigo2`. 



## 1.3 Método para remover amigo 

Implemente um método chamado `remover_amigo` que recebe um objeto `amigo2` da classe `User`.

Este amigo passado deve ser removido da lista de amigos do objeto atual.  A variável `qtd_amigos` deve ser ajustada corretamente tanto no `self` quanto no objeto passado.  


Exemplo de uso. Note que você vai programar num contexto em que `amigo1` será o `self`.: 

```python
    removeu = amigo1.remover_amigo(amigo2)
```

Este método deve retornar `True` se o amigo foi devidamente removido, e caso contrário retornar `False` se o objeto passado não estava entre os amigos. Não se pode remover um amigo que não estava na lista. 

O objeto da classe `User` deve também se remover do `amigo2`. 

## 1.4 Método para escrever post e adicionar à *timeline*

Crie um método chamado `escrever_post` na classe `User`.  

O método deve receber uma `str` com o conteúdo do post e usá-lo para instanciar um objeto da classe `Post` e adicioná-lo à *timeline* do objeto da classe `User`. 

Para facilidade de testes no futuro, além de adicionar na *timeline* este método retorna o objeto `Post` que foi criado. 

## 1.4 Método para remover post da timeline 

O método deve se chamar `remover_post_da_timeline`.

Este método deve pertencer à classe `User`. Recebe um *post* e o remove da *timeline*. 

Deve-se validar se o `Post` está mesmo na *timeline*.

## 1.6 Método para comentar post 

Crie um método na classe `User` chamado `comentar_post` que: 

* Recebe um objeto `Post` já criado. Este `Post` pode pertencer a outro `User`
* Recebe uma `str` com uma mensagem
* Cria um objeto da classe `Comment` contendo a mensagem
* Adiciona o novo `Comment` como comentário ao `Post`

Devolve o objeto `Comment` criado

Atenção: só se pode comentar um `Post` se ele for de um amigo do `User`. 

## 1.7 Método para remover comentário do post 

O método desta seção deve se chamar `remover_comentario_do_post`. 

Este método recebe um objeto `Post` e um objeto `Comment`.  

O `Comment` deve ser removido do `Post`

Uma regra que deve ser seguida é que somente o autor do Post ou o autor do comentário Comment podem excluir comentário. 


[Q2 - Próxima Questão](Q2.md)

# 2. Questão sobre testes unitários 
**(2 pontos)**

Trabalhe no arquivo [test_unit_test_prova.py](./src/test/test_unit_test_prova.py).  Nenhum destes testes vai envolver banco de dados. Trabalharão com objetos das classes descritas na Questão 1. 

O que deve ser feito: 

Leia as descrições dos testes unitários abaixo e cria a lógica para funcionarem no arquivo mencionado acima: 

```python
def test_adicionar_comentario_repetido_na_classe_Post():
    """Testa se o método adicionar_comentario() da classe Post permite que se adicionem comentários repetidos
        Um comentário repetido é um comentário com o mesmo conteúdo de outro previamente existente
        Não se deve testar se o objeto é igual
        Deve fazer uma asserção para False se permitir adicionar comentários repetidos
        Mas você não vai precisar corrigir isso
        """
    pass

def test_remover_comentario_da_classe_Post():
    """Testa se o método remover_comentario() da classe Post permite que se remova um comentário
        Deve fazer uma asserção para True se permitir remover um comentário corretamente
    """
    pass    

def test_se_to_dict_retornado_corretamente_na_classe_Comment():
    """Testa se o método to_dict() da classe Comment retorna um dicionário com as informações corretas
        Inspecione o código de Comment para entender como este método funciona
    """
    pass
```

Atenção: os *pytest* markers foram removidos neste enunciado mas estão presentes no arquivo. 

Rubrica: 

|---|---|
|1 teste| 0.7 |
|2 testes | 1.4 | 
|3 testes | 2.0 | 


[Q2 - Próxima Questão](Q3.md)



# Questão sobre Flask e BD 

Neste exercício vamos definir rotas e endpoints para tentar trabalhar com a classe `User` de maneira mais próxima a REST. Não será necessário usar Flask RESTFul mas sim usar rotas, valores de retorno e métodos HTTP corretamente. 

Dica: [Pode ser útil rever este exemplo de banco de dados visto no hands-on em aula](https://github.com/Tiagoeem/ProjAgil_hands-on_Finais_2022/blob/main/semana_5/src/app.py). Você também pode consultar qualquer documentação na internet. 

Este item não conta com testes unitários, mas o arquivo [Prova_Agil_2022_2.postman_collection.json](./src/test/para_postman/Prova_Agil_2022_2.postman_collection.json) tem exemplos de requests e qual a resposta adequada.









